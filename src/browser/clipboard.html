<div class="text">一段示例文字！</div>
<button class="do">选中并复制</button>&nbsp;
<button class="cancel">取消选中</button>
<button class="read">读取剪切板</button>
<br /><br />
<textarea id="content" id="" cols="30" rows="10"></textarea><br />
<div class="preview" style="margin-top: 10px;"></div>
<script>
    $ = (spec) => document.querySelector(spec)

    $('.do').addEventListener('click', () => {
        const selection = window.getSelection()
        const range = document.createRange()
        range.selectNodeContents($('.text')) // RangeAPI: 制造区域
        selection.addRange(range) // Selection: 选中区域
        const selectedText = selection.toString()

        // 写入剪切板
        navigator.clipboard.writeText(selectedText)
    })

    $('.cancel').addEventListener('click', () => {
        window.getSelection().removeAllRanges()
    })

    $('.read').onclick = async () => {
        // 是否能够有读取剪贴板的权限
        // result.state == "granted" || result.state == "prompt"
        const result = await navigator.permissions.query({
            name: 'clipboard-read'
        })

        // 获取剪贴板内容
        const text = await navigator.clipboard.readText()
        alert(text)
    }

    $('#content').onpaste = (evt) => {
        let clipboardData = evt.clipboardData
        for (let i = 0; i < clipboardData.items.length; i++) {
            let item = clipboardData.items[i]
            if (item.kind == 'file' && item.type.match(/^image\//i)) {
                let blob = item.getAsFile()
                const dataUrl = URL.createObjectURL(blob)
                $('.preview').innerHTML = `<img src="${dataUrl}" width="90%">`
            }
        }
    }

    // 第三方库：
    // npm i clipboard-copy
    // npm i select
</script>
